<!DOCTYPE html>
<html>
	<head>
		<meta charset="UTF-8" />
		<meta content="IE=Edge" http-equiv="X-UA-Compatible" />
		<meta name="description" content="A new Flutter project." />

		<meta name="apple-mobile-web-app-capable" content="yes" />
		<meta name="apple-mobile-web-app-status-bar-style" content="black" />
		<meta name="apple-mobile-web-app-title" content="stat_flutter" />
		<link rel="apple-touch-icon" href="icons/Icon-192.png" />

		<link rel="icon" type="image/png" href="favicon.jpg" />

		<title>stat_flutter</title>
		<link rel="manifest" href="manifest.json" />
	</head>
	<body>
		<script src="https://www.gstatic.com/firebasejs/8.6.1/firebase-app.js"></script>
		<script src="https://www.gstatic.com/firebasejs/8.6.1/firebase-auth.js"></script>
		<script src="https://www.gstatic.com/firebasejs/8.6.1/firebase-firestore.js"></script>
		<script src="https://www.gstatic.com/firebasejs/8.6.1/firebase-messaging.js"></script>
		<script src="https://www.gstatic.com/firebasejs/8.6.1/firebase-analytics.js"></script>

		<script src="firebase-messaging-sw.js"></script>
		<script>
			if ("serviceWorker" in navigator) {
				window.addEventListener("flutter-first-frame", function () {
					navigator.serviceWorker.register(
						"flutter_service_worker.js"
					);
				});
			}

			var firebaseConfig = {
				apiKey: "AIzaSyDeoFgfHkaRsn_3gfGTT6bCibus8UIlGbA",
				authDomain: "stat-flutter-c4e6a.firebaseapp.com",
				projectId: "stat-flutter-c4e6a",
				storageBucket: "stat-flutter-c4e6a.appspot.com",
				messagingSenderId: "189623070407",
				appId: "1:189623070407:web:b87f4e699a302a8da4d8e2",
				measurementId: "G-KTP54HGT2H",
			};
			firebase.initializeApp(firebaseConfig);
			firebase.analytics();

			// Retrieve Firebase Messaging object.
			const messaging = firebase.messaging();

			messaging.setBackgroundMessageHandler(function (payload) {
				const promiseChain = clients
					.matchAll({
						type: "window",
						includeUncontrolled: true,
					})
					.then((windowClients) => {
						for (let i = 0; i < windowClients.length; i++) {
							const windowClient = windowClients[i];
							windowClient.postMessage(payload);
						}
					})
					.then(() => {
						return registration.showNotification("New Message");
					});
				return promiseChain;
			});

			self.addEventListener("notificationclick", function (event) {
				console.log("notification received: ", event);
			});
		</script>
		<!--<script src="firebase-messaging-sw.js"></script>-->
		<script src="main.dart.js" type="application/javascript"></script>
	</body>
</html>
